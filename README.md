# Прогнозирование цен на автомобили

### Что было сделано:
#### 1) EDA и предобработка данных
Базовый анализ данных: Проверка размеров датасетов, случайных строк, пропусков, дубликатов
Обработка пропусков: Заполнение медианами для mileage, engine, max_power, seats
Очистка данных:
- Удаление явных дубликатов (удалено 1159 строк в train, 62 в test)
- Преобразование типов данных из строк в числа 
- Удаление столбца torque
- Визуализация парных зависимостей между признаками, построение тепловой карты корреляций, Boxplot для анализа связи seats с engine и year

#### Выводы из EDA: 
Датасет состоит из 7 числовых, 5 категориальных признаков, train и test схожи по распределению данных 
Обнаружены корреляции: 
- Сильная положительная: year - selling_price
- Сильная положительная: max_power - selling_price
- Умеренно отрицательная: year - km_driven
- Слабая: mileage - selling_price 

#### 2) Модель на вещественных признаках
Была использована Линейная регрессия
Регуляризации: Lasso, ElasticNet, Ridge с разными параметрами
Оптимизация гиперпараметров: GridSearchCV для Lasso, ElasticNet, Ridge

#### 3) Добавление категориальных признаков
OneHot Encoding: Кодирование категориальных признаков
Обучение Ridge регрессии с категориальными признаками

#### 4) Реализация расчета бизнес метрики 
Разработка кастомной метрики: Доля прогнозов с ошибкой ≤10%

### Полученные результаты: 
Полученные значения R2: 
- Linear Regression (без категориальных признаков): 0.59414
- Linear Regression со стандартизацией: 0.59414 (улучшения в значении метрик нет, но это ожидаемо, тк здесь было изменено только масштабироавние признаков) 
- Lasso (alpha=10000.0): 0.58159 (Lasso позволило занулить признак "seats", однако это не дало прироста в качестве). Значения Lasso >10 000 ухудшали качество сильнее, значения <1000 не давали изменений в качестве, тк регуляризация не работала
- Ridge (с категориальными признаками): 0.61426 

#### Выводы: 
Лучшая модель: Ridge с категориальными признаками R2 = 0.61 
  
